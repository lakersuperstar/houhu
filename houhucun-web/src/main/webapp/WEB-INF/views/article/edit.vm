#set($layout="editlayout.vm")
#set($staticPath1="$request.contextPath/assets")
#set($ctx="$request.contextPath")
<!DOCTYPE html>
<html>

<head>
<meta charset="utf-8">
<title>文章编辑器</title>
<script type="text/javascript" src="$staticPath1/js/jquery-1.10.2.js"></script>
<script type="text/javascript"
	src="$staticPath1/ueditor/ueditor.config.js"></script>
<script type="text/javascript" src="$staticPath1/ueditor/ueditor.all.js"></script>
<link href="$staticPath1/css/edit.css" rel="stylesheet" type="text/css" />
<link href="$staticPath1/css/editv2.css" rel="stylesheet"
	type="text/css" />
</head>

<body class="admin">
	<ul>
		<li style="float: left">


			<div class="page-container">
				<div id="editor">
					<div class="wxb-index-wrap mode-normal container">
						<div class="editor-form">
							<form action="${ctx}/article/add" id="addInfo" method="post">
								<div class="form-wrap">
									<div id="editorFloat" class="editor-float only-normal">
										<input class="editor-input editor-title"
											placeholder="请在这里输入标题" name="title" type="text" id="titleId">
										<input class="editor-input editor-author" placeholder="请输入作者"
											name="writer" id="writerId" type="text"> <input
											type="hidden" name="info" id="infoId" />
									</div>

									<div class="editor-content-area">
										<div class="form-content-wrap">
											<div class="content-wrap edui-default">
												<div id="js_editor" class="edui-editor  edui-default"
													style="width: 736px; z-index: 999;"></div>
											</div>
										</div>
									</div>
								</div>

							</form>
						</div>
					</div>
				</div>

			</div>

		</li>
		<li style="float: left">
			<div
				style="width: 739px; text-align: center; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0">
				<br> <a href='#' id="ok" class='classNameBut'>保存文章</a>
			</div>

		</li>
	</ul>
	<script type="text/javascript">
		var editorId = "appmsg_editor";
		// 		var URL = window.UEDITOR_HOME_URL || getUEBasePath();
		var editor = UE.getEditor("js_editor", {
			id : editorId,
			imageUrl : "php/imageUp.php", //图片上传提交地址
			imagePath : "", //图片修正地址，引用了fixedImagePath,如有特殊需求，可自行配,
			imageFieldName : "upfile",
			/* 上传图片配置项 */
			imageActionName : "uploadimage", /* 执行上传图片的action名称 */
			imageFieldName : "iocn", /* 提交的图片表单名称 */
			imageUrlPrefix : "/",
			imageMaxSize : 2048000, /* 上传大小限制，单位B */
			imageAllowFiles : [ ".png", ".jpg", ".jpeg", ".gif", ".bmp" ], /* 上传图片格式显示 */
			imageCompressEnable : true, /* 是否压缩图片,默认是true */
			imageCompressBorder : 1600, /* 图片压缩最长边限制 */
			// 初始化编辑器宽度
			initialFrameWidth : "auto",
			// 初始化编辑器高度
			initialFrameHeight : 330,
			// 启用自动保存
			enableAutoSave : false,
			// 微信主题
			theme : 'wx',
			themePath : "../assets/ueditor/themes/",
			wordCount : false,
			elementPathEnabled : false,
			toolbars : [
					[ "more", "|", "fontsize", "|", "blockquote", "horizontal",
							"|", "removeformat", "|", "insertvideo",
							"insertimage" ],
					[ "bold", "italic", "underline", "forecolor", "backcolor",
							"|", "justifyleft", "justifycenter",
							"justifyright", "|", "rowspacingtop",
							"rowspacingbottom", "lineheight", "|",
							"insertorderedlist", "insertunorderedlist", "|",
							"imagenone", "imageleft", "imageright",
							"imagecenter" ] ]
		});
		UE.Editor.prototype._bkGetActionUrl = UE.Editor.prototype.getActionUrl;
		UE.Editor.prototype.getActionUrl = function(action) {
			if (action == 'uploadimage' || action == 'uploadscrawl'
					|| action == 'uploadimage') {
				return 'http://10.6.60.72:8084/img/upload';
			} else if (action == 'uploadvideo') {
				return 'http://a.b.com/video.php';
			} else {
				return this._bkGetActionUrl.call(this, action);
			}
		}
		editor.addListener("catchremotesuccess", function() {
			tips.success("内容已上传完成");
		});
		editor.addListener("catchremoteerror", function() {
			tips.error("远程图片抓取失败");
		});
		// 		editor
		// 				.ready(function() {
		// 					var toolbars = editor.ui.toolbars;
		// 					$('#' + editor.ui.toolbars[0].id).addClass(
		// 							"edui-toolbar-primary");
		// 					$('#' + editor.ui.toolbars[1].id).addClass(
		// 							"edui-toobar-secondary");
		// 					$("#" + editorId + "_toolbarbox")
		// 							.addClass("show-edui-more");
		// 					for (var i = 0; i < toolbars.length; i++) {
		// 						var toolbar = toolbars[i];
		// 						var items = toolbar.items;
		// 						for (var j = 0; j < items.length; j++) {
		// 							if (items[j] instanceof UE.ui.Combox
		// 									|| items[j] instanceof UE.ui.SplitButton) {
		// 								$("#" + items[j].id + "_state").tooltip({
		// 									container : 'body'
		// 								});
		// 							} else if (items[j] instanceof UE.ui.Button
		// 									|| items[j] instanceof UE.ui.MenuButton) {
		// 								$("#" + items[j].id + "_body").tooltip({
		// 									container : 'body'
		// 								});
		// 							}
		// 						}
		// 					}
		// 				});

		$("#ok").click(function() {
			var data = editor.getContent();
			$("#infoId").val(data);
			$("#addInfo").submit();
		});
	</script>
</body>

</html>
